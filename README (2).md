# 📘 지목변경신청서 → 토지이동신청서 자동화 Excel 생성 스크립트

이 프로젝트는 **지목변경신청서(Excel)** 데이터를 기반으로\
**토지이동신청서(페이지 구조 포함) Excel 문서를 자동 생성**하는 Python
스크립트입니다.

여러 장의 행정 문서를 사람이 일일이 작성하던 작업을\
지번 정렬, 페이지 분배, 병합셀 안전 처리 등 **전체 과정을 완전
자동화**한 프로젝트입니다.

------------------------------------------------------------------------

## 🚀 주요 기능

  -----------------------------------------------------------------------
  기능                                설명
  ----------------------------------- -----------------------------------
  ✔ **지목변경신청서(원본 Excel) 자동 사용자 지정 컬럼 기반
  읽기**                              

  ✔ **지번(산/본번-부번) 자연 정렬    '산', 본번·부번 구조 정렬
  지원**                              

  ✔ **토지이동신청서 템플릿 자동      1페이지·2페이지 이상 연속 페이지
  채움**                              자동 생성

  ✔ **병합셀 안전 기록 처리**         merged cell 구조 자동 인식 후
                                      앵커셀만 기록

  ✔ **소속 그룹(동리) 단위 파일 자동  그룹별 1개 엑셀 파일 생성
  생성**                              

  ✔ **페이지 자동 분할(1쪽 6행 / 2쪽  행 수에 따라 페이지 자동 증가
  이후 30행)**                        

  ✔ **열 너비/서식 복제**             템플릿 그대로 스타일 유지

  ✔ **병합 영역 중복 초기화 방지**    visited 기반 안전 초기화
  -----------------------------------------------------------------------

------------------------------------------------------------------------

## 📁 폴더 구조

    project/
    │
    ├── in/
    │   ├── 지목변경신청서_통합.xlsx
    │   └── 토지이동신청서_페이지.xlsx
    │
    ├── out/
    │   ├── A동.xlsx
    │   ├── B동.xlsx
    │   └── ...
    │
    ├── fill_land_request.py
    └── README.md

------------------------------------------------------------------------

## ⚙️ 실행 환경

### 🔧 요구 패키지

    pip install pandas openpyxl

### Python 버전

-   Python 3.8 이상 권장

------------------------------------------------------------------------

## ▶ 실행 방법

1.  **입력 파일 위치 설정**

``` python
SRC_PATH = "./in/지목변경신청서_통합.xlsx"
TEMPLATE_PATH = "./in/토지이동신청서_페이지.xlsx"
```

2.  **출력 폴더 설정**

``` python
OUT_DIR = Path("./out")
```

3.  **실행**

```{=html}
<!-- -->
```
    python 토지이동신청서_지목변경.pyc

------------------------------------------------------------------------

## 📊 데이터 처리 방식

### 1) 필수 컬럼 검증

  구분       컬럼명
  ---------- ------------------------------------
  그룹       동리
  행정구역   시군, 읍면, 동리
  이동전     이동전지번, 이동전지목, 이동전면적
  이동후     이동후지번, 이동후지목, 이동후면적

------------------------------------------------------------------------

### 2) 지번 자연 정렬

정규식 기반으로\
**산 여부 → 본번 → 부번** 기준 정렬:

예)

    산12-1 → (1, 12, 1)
    12-3   → (0, 12, 3)
    12     → (0, 12, 0)

------------------------------------------------------------------------

### 3) 그룹 단위 파일 생성

동리별로 파일이 자동 생성됩니다.

예)

    A동.xlsx
    B동.xlsx
    C동.xlsx

------------------------------------------------------------------------

## 📘 페이지 구성 로직

### 📄 1쪽 (6행)

-   17행부터 6행 기록
-   병합 셀 포함된 테이블 초기화 후 기록

### 📄 2쪽 이후 (30행)

-   2페이지 시트를 복제하여 3·4·5페이지 자동 생성
-   기존 서식 유지
-   초기화 없이 덮어쓰기 방식

------------------------------------------------------------------------

## 🧠 병합셀 처리 방식

-   병합 영역에 값 기록 시 **좌상단 셀에만 기록**
-   초기화 시 중복 삭제 방지를 위해 **visited 관리**
-   서식(Font, Align, Border, Width 등) 완전 복제

------------------------------------------------------------------------

## 🧩 주요 함수

### `write_safe`

병합 여부 확인 후 안전하게 값 기록.

### `clear_sheet_contents`

병합 셀을 고려하여 테이블 범위 초기화.

### `fill_group_across_pages`

그룹 데이터를 페이지 여러 장에 자동 분배.

### `get_or_clone_page_sheet`

2쪽 템플릿을 복제해 3·4·5쪽 시트 자동 생성.

------------------------------------------------------------------------

## 📘 전체 처리 흐름

    1) 원본 Excel(지목변경신청서) 로딩
    2) 지번 자연 정렬
    3) 그룹(동리)별 데이터 분리
    4) 각 그룹에 대해:
         a. 템플릿 로딩
         b. 1쪽/2쪽/3쪽 자동 작성
         c. 그룹명.xlsx 파일로 저장

------------------------------------------------------------------------

## 🏁 출력 예시

    out/
    ├── 삼산리.xlsx
    ├── 신촌리.xlsx
    ├── 해남리.xlsx
    └── 화남리.xlsx

------------------------------------------------------------------------

## 📚 기술 스택

-   Python\
-   pandas\
-   openpyxl\
-   정규식 기반 지번 파싱\
-   병합셀 처리 알고리즘

------------------------------------------------------------------------

## ✨ 마무리

이 스크립트는 **행정 문서 자동화**를 위해 설계된 도구입니다.\
특히 **병합셀 기반 행정 양식 자동 생성** 기능이 강력하며,\
반복 업무를 자동화하여 **작업 시간을 획기적으로 단축**할 수 있습니다.

필요하면 **PDF 버전 / DOCX 버전 / 포트폴리오용 확장 설명**도 제작해
드릴게요!
